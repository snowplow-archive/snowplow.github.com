<!DOCTYPE html>
<html>
<head>
	
	<title>Data structure - SnowPlow Analytics</title>
	

	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<link href="/static/css/styles.css" type="text/css" rel="stylesheet" />
	<link href="/static/css/pygments.css" type="text/css" rel="stylesheet" />
	

	<!-- SnowPlow starts plowing -->
	<script type="text/javascript">
	var _snaq = _snaq || [];

	_snaq.push(['setAccount', 'd3v6ndkyapxc2w']);
	_snaq.push(['trackPageView']);
	_snaq.push(['enableLinkTracking']);

	(function() {
	var sp = document.createElement('script'); sp.type = 'text/javascript'; sp.async = true; sp.defer = true;
	sp.src = ('https:' == document.location.protocol ? 'https' : 'http') + '://d1fc8wv8zag5ca.cloudfront.net/sp.js';
	var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(sp, s);
	})();
	 </script>
	<!-- SnowPlow stops plowing -->	

	<!--Google Analytics tracking-->
	<script type="text/javascript">

	  var _gaq = _gaq || [];
	  _gaq.push(['_setAccount', 'UA-34290195-1']);
	  _gaq.push(['_trackPageview']);

	  (function() {
	    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	  })();

	</script>
	<!--Finish Google Analytics tracking-->
</head>
<body>
	<div id="container">
		<div id="header" class="span-24">
  <div id="logo">
    <h1><a href="/">SnowPlow</a></h1>
    <p>Your web analytics data in your hands</p>
  </div>
  <div id="menu" class="span-15">
    <ul>
      <li ><a href="/product/index.html">Product</a></li>
      <li ><a href="/services/index.html">Services</a></li>
      <li  class="active" ><a href="/analytics/index.html">Analytics</a></li>
      <li ><a href="/technology/index.html">Technology</a></li>
      <li ><a href="/blog.html">Blog</a></li>
      <li ><a id="mail" href="/contact/index.html">Contact</a></li>
    </ul>
  </div>
</div>
	
		<div id="contents">
<h1 id='snowplow_table_structure'>SnowPlow table structure</h1>

<p>SnowPlow data is stored in a single Apache Hive table. Each line in the table represents a single event, be that a page view, add-to-basket, video play etc.</p>

<p>The table structures for SnowPlow data in Hive and Infobright are almost identical. We&#8217;ll cover the structure of the <a href='#hive-table-definition'>Hive table</a> before looking at the <a href='#infobright'>Infobright table definition</a> to see how it differs.</p>
<a name='hive-table-definition' />
<h2 id='hive_table_definitions'>Hive table definitions</h2>

<p>Understanding the SnowPlow table structure(s) in Hive is a pre-requisite to being able to write your own HiveQL queries.</p>

<p>The Hive table generated by <strong>SnowPlowEventDeserializer</strong> to hold SnowPlow-logged page views and events looks like this:</p>
<table><thead><tr><th><strong>FIELD</strong></th><th><strong>DATATYPE</strong></th><th><strong>CAN BE EMPTY?</strong></th><th><strong>DESCRIPTION</strong></th></tr></thead><tbody><tr><td style='text-align: left;'><strong>Date/time</strong></td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'><em>The date and time of this page view or event</em></td>
</tr><tr><td style='text-align: left;'><code>dt</code></td><td style='text-align: left;'>STRING</td><td style='text-align: left;'>No</td><td style='text-align: left;'>Date</td>
</tr><tr><td style='text-align: left;'><code>tm</code></td><td style='text-align: left;'>STRING</td><td style='text-align: left;'>No</td><td style='text-align: left;'>Time</td>
</tr><tr><td style='text-align: left;'><strong>Transaction</strong></td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'><em>Identifying this logging event</em></td>
</tr><tr><td style='text-align: left;'><code>txn_id</code></td><td style='text-align: left;'>STRING</td><td style='text-align: left;'>No</td><td style='text-align: left;'>A unique event ID. If two or more records have the same txn_id, one is a duplicate record</td>
</tr><tr><td style='text-align: left;'><strong>User and visit</strong></td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'><em>Identifying the web user and this specific visit</em></td>
</tr><tr><td style='text-align: left;'><code>user_id</code></td><td style='text-align: left;'>STRING</td><td style='text-align: left;'>No</td><td style='text-align: left;'>A unique ID assigned to each browser and stored on the SnowPlow cookie.</td>
</tr><tr><td style='text-align: left;'><code>user_ipaddress</code></td><td style='text-align: left;'>STRING</td><td style='text-align: left;'>No</td><td style='text-align: left;'>Visitor IP Address</td>
</tr><tr><td style='text-align: left;'><code>visit_id</code></td><td style='text-align: left;'>INT</td><td style='text-align: left;'>No</td><td style='text-align: left;'>A counter that indicates what visit this is for this particular user_id i.e. 1 if this is a user&#8217;s first visit, 2 if it is his / her 2nd visit</td>
</tr><tr><td style='text-align: left;'><strong>Page</strong></td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'><em>Identifying the web page being visited</em></td>
</tr><tr><td style='text-align: left;'><code>page_url</code></td><td style='text-align: left;'>STRING</td><td style='text-align: left;'>No</td><td style='text-align: left;'>The web page URL</td>
</tr><tr><td style='text-align: left;'><code>page_title</code></td><td style='text-align: left;'>STRING</td><td style='text-align: left;'>Yes</td><td style='text-align: left;'>The web page title</td>
</tr><tr><td style='text-align: left;'><code>page_referrer</code></td><td style='text-align: left;'>STRING</td><td style='text-align: left;'>No</td><td style='text-align: left;'>The referrer URL. If this is the first page view of a session, it points at the referrering website / search engine if applicable</td>
</tr><tr><td style='text-align: left;'><strong>Marketing</strong></td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'><em>Marketing campaign attribution</em></td>
</tr><tr><td style='text-align: left;'><code>mkt_medium</code></td><td style='text-align: left;'>STRING</td><td style='text-align: left;'>Yes</td><td style='text-align: left;'>The type of ad used e.g. cpc, banner, email, affiliate&#8230;</td>
</tr><tr><td style='text-align: left;'><code>mkt_source</code></td><td style='text-align: left;'>STRING</td><td style='text-align: left;'>Yes</td><td style='text-align: left;'>The source of the ad: used e.g. Google, MSN, Facebook, TradeDoubler</td>
</tr><tr><td style='text-align: left;'><code>mkt_term</code></td><td style='text-align: left;'>STRING</td><td style='text-align: left;'>Yes</td><td style='text-align: left;'>Any keywords associated with the ad. This is relevant for search ads</td>
</tr><tr><td style='text-align: left;'><code>mkt_content</code></td><td style='text-align: left;'>STRING</td><td style='text-align: left;'>Yes</td><td style='text-align: left;'>The content of the ad, or a reference to the creative ID. Used e.g. to compare the results within a campaign between different creatives.</td>
</tr><tr><td style='text-align: left;'><code>mkt_campaign</code></td><td style='text-align: left;'>STRING</td><td style='text-align: left;'>Yes</td><td style='text-align: left;'>The campaign name. A single campaign may involve ads on multiple sources / mediums, so <code>mkt_campaign</code> is often a way of grouping them together into a single marketing initiative</td>
</tr><tr><td style='text-align: left;'><strong>Event</strong></td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'><em>If this is an event being logged, its details</em></td>
</tr><tr><td style='text-align: left;'><code>ev_category</code></td><td style='text-align: left;'>STRING</td><td style='text-align: left;'>Yes</td><td style='text-align: left;'>The category of event e.g. &#8216;ecomm&#8217;, &#8216;media&#8217;</td>
</tr><tr><td style='text-align: left;'><code>ev_action</code></td><td style='text-align: left;'>STRING</td><td style='text-align: left;'>Yes</td><td style='text-align: left;'>The action performed e.g. &#8216;play-video&#8217;, &#8216;add-to-basket&#8217;</td>
</tr><tr><td style='text-align: left;'><code>ev_label</code></td><td style='text-align: left;'>STRING</td><td style='text-align: left;'>Yes</td><td style='text-align: left;'>A label associated with the event / action. This is often set to the <em>object</em> and action is performed <em>on</em> e.g. the product_id of the item added-to-basket, or the ID of the video played</td>
</tr><tr><td style='text-align: left;'><code>ev_property</code></td><td style='text-align: left;'>STRING</td><td style='text-align: left;'>Yes</td><td style='text-align: left;'>A property associated with the event / action. This might be the number of seconds into a video play starts, or the quantity of an item added to basket</td>
</tr><tr><td style='text-align: left;'><code>ev_value</code></td><td style='text-align: left;'>STRING</td><td style='text-align: left;'>Yes</td><td style='text-align: left;'>A value associated with with the action e.g. the value of the items added to basket</td>
</tr><tr><td style='text-align: left;'><strong>Browser</strong></td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'><em>Information about the web browser</em></td>
</tr><tr><td style='text-align: left;'><code>br_name</code></td><td style='text-align: left;'>STRING</td><td style='text-align: left;'>TBC</td><td style='text-align: left;'>Browser name e.g. Internet Explorer</td>
</tr><tr><td style='text-align: left;'><code>br_family</code></td><td style='text-align: left;'>STRING</td><td style='text-align: left;'>TBC</td><td style='text-align: left;'>Browser family e.g. Chrome</td>
</tr><tr><td style='text-align: left;'><code>br_version</code></td><td style='text-align: left;'>STRING</td><td style='text-align: left;'>TBC</td><td style='text-align: left;'>Browser version</td>
</tr><tr><td style='text-align: left;'><code>br_type</code></td><td style='text-align: left;'>STRING</td><td style='text-align: left;'>TBC</td><td style='text-align: left;'>Type of client e.g. Browser, robot</td>
</tr><tr><td style='text-align: left;'><code>br_renderengine</code></td><td style='text-align: left;'>STRING</td><td style='text-align: left;'>TBC</td><td style='text-align: left;'>Browser rendering engine e.g. GECKO, WEBKIT</td>
</tr><tr><td style='text-align: left;'><code>br_lang</code></td><td style='text-align: left;'>STRING</td><td style='text-align: left;'>No</td><td style='text-align: left;'>Language that the browser is set to</td>
</tr><tr><td style='text-align: left;'><code>br_features</code></td><td style='text-align: left;'>ARRAY[STRING]</td><td style='text-align: left;'>Yes</td><td style='text-align: left;'>Contains a set of all features supported by this browser, e.g. <code>fla</code> for Flash, <code>pdf</code> for PDF support</td>
</tr><tr><td style='text-align: left;'><code>br_cookies</code></td><td style='text-align: left;'>BOOLEAN</td><td style='text-align: left;'>No</td><td style='text-align: left;'>Flag set to &#8216;true&#8217; if browser permits cookies</td>
</tr><tr><td style='text-align: left;'><strong>Operating System</strong></td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'><em>Information about the host operating system</em></td>
</tr><tr><td style='text-align: left;'><code>os_name</code></td><td style='text-align: left;'>STRING</td><td style='text-align: left;'>TBC</td><td style='text-align: left;'>Operating system name e.g. Windows</td>
</tr><tr><td style='text-align: left;'><code>os_family</code></td><td style='text-align: left;'>STRING</td><td style='text-align: left;'>TBC</td><td style='text-align: left;'>Operating system family e.g. Android</td>
</tr><tr><td style='text-align: left;'><code>os_manufacturer</code></td><td style='text-align: left;'>STRING</td><td style='text-align: left;'>TBC</td><td style='text-align: left;'>Operating system manufacturer e.g. Apple Inc., Google Inc.</td>
</tr><tr><td style='text-align: left;'><strong>Device/Hardware</strong></td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'><em>Information about the host device/hardware</em></td>
</tr><tr><td style='text-align: left;'><code>dvce_type</code></td><td style='text-align: left;'>STRING</td><td style='text-align: left;'>TBC</td><td style='text-align: left;'>Device type e.g. computer, mobile&#8230;</td>
</tr><tr><td style='text-align: left;'><code>dvce_ismobile</code></td><td style='text-align: left;'>BOOLEAN</td><td style='text-align: left;'>TBC</td><td style='text-align: left;'>Flag set if user is browsing on a mobile device</td>
</tr><tr><td style='text-align: left;'><code>dvce_screenwidth</code></td><td style='text-align: left;'>INT</td><td style='text-align: left;'>No</td><td style='text-align: left;'>Screenwidth in pixels</td>
</tr><tr><td style='text-align: left;'><code>dvce_screenheight</code></td><td style='text-align: left;'>INT</td><td style='text-align: left;'>No</td><td style='text-align: left;'>Screenheight in pixels</td>
</tr></tbody></table><a name='infobright' />
<h2 id='infobright_table_definitions'>Infobright table definitions</h2>

<p>The Infobright table definition is very similar to the Hive table definition. Two differences are worth noting:</p>

<ol>
<li>The data types for a number of fields are different. Hive is very good at casting e.g. STRINGs as FLOATs implicitly where possibly and explicitly where required at query time. Infobright is less good, so some of the fields that are set to STRING in Hive (e.g. ev_value) are set to numeric types in Infobright.</li>

<li>Infobright does not support the ARRAY data type used for the <code>br_features</code> field. Rather than pack all the different browser features in a single array, then, a separate column is used to store each possible browser feature.</li>
</ol>

<p>The Infobright table looks like this:</p>
<table><thead><tr><th><strong>FIELD</strong></th><th><strong>DATATYPE</strong></th></tr></thead><tbody><tr><td style='text-align: left;'>dt</td><td style='text-align: left;'>date</td>
</tr><tr><td style='text-align: left;'>tm</td><td style='text-align: left;'>time</td>
</tr><tr><td style='text-align: left;'>txn_id</td><td style='text-align: left;'>int(11)</td>
</tr><tr><td style='text-align: left;'>user_id</td><td style='text-align: left;'>varchar(16)</td>
</tr><tr><td style='text-align: left;'>user_ipaddress</td><td style='text-align: left;'>varchar(19)</td>
</tr><tr><td style='text-align: left;'>visit_id</td><td style='text-align: left;'>smallint(6)</td>
</tr><tr><td style='text-align: left;'>page_url</td><td style='text-align: left;'>varchar(2083)</td>
</tr><tr><td style='text-align: left;'>page_title</td><td style='text-align: left;'>varchar(2083)</td>
</tr><tr><td style='text-align: left;'>page_referrer</td><td style='text-align: left;'>varchar(2083)</td>
</tr><tr><td style='text-align: left;'>mkt_source</td><td style='text-align: left;'>varchar(255)</td>
</tr><tr><td style='text-align: left;'>mkt_medium</td><td style='text-align: left;'>varchar(255)</td>
</tr><tr><td style='text-align: left;'>mkt_term</td><td style='text-align: left;'>varchar(255)</td>
</tr><tr><td style='text-align: left;'>mkt_content</td><td style='text-align: left;'>varchar(2083)</td>
</tr><tr><td style='text-align: left;'>mkt_name</td><td style='text-align: left;'>varchar(255)</td>
</tr><tr><td style='text-align: left;'>ev_category</td><td style='text-align: left;'>varchar(255)</td>
</tr><tr><td style='text-align: left;'>ev_action</td><td style='text-align: left;'>varchar(255)</td>
</tr><tr><td style='text-align: left;'>ev_label</td><td style='text-align: left;'>varchar(255)</td>
</tr><tr><td style='text-align: left;'>ev_property</td><td style='text-align: left;'>varchar(255)</td>
</tr><tr><td style='text-align: left;'>ev_value</td><td style='text-align: left;'>float</td>
</tr><tr><td style='text-align: left;'>br_name</td><td style='text-align: left;'>varchar(30)</td>
</tr><tr><td style='text-align: left;'>br_family</td><td style='text-align: left;'>varchar(30)</td>
</tr><tr><td style='text-align: left;'>br_version</td><td style='text-align: left;'>varchar(30)</td>
</tr><tr><td style='text-align: left;'>br_type</td><td style='text-align: left;'>varchar(30)</td>
</tr><tr><td style='text-align: left;'>br_renderengine</td><td style='text-align: left;'>varchar(30)</td>
</tr><tr><td style='text-align: left;'>br_lang</td><td style='text-align: left;'>varchar(10)</td>
</tr><tr><td style='text-align: left;'>br_features_pdf</td><td style='text-align: left;'>tinyint(1)</td>
</tr><tr><td style='text-align: left;'>br_features_flash</td><td style='text-align: left;'>tinyint(1)</td>
</tr><tr><td style='text-align: left;'>br_features_java</td><td style='text-align: left;'>tinyint(1)</td>
</tr><tr><td style='text-align: left;'>br_features_director</td><td style='text-align: left;'>tinyint(1)</td>
</tr><tr><td style='text-align: left;'>br_features_quicktime</td><td style='text-align: left;'>tinyint(1)</td>
</tr><tr><td style='text-align: left;'>br_features_realplayer</td><td style='text-align: left;'>tinyint(1)</td>
</tr><tr><td style='text-align: left;'>br_features_windowsmedia</td><td style='text-align: left;'>tinyint(1)</td>
</tr><tr><td style='text-align: left;'>br_features_gears</td><td style='text-align: left;'>tinyint(1)</td>
</tr><tr><td style='text-align: left;'>br_features_silverlight</td><td style='text-align: left;'>tinyint(1)</td>
</tr><tr><td style='text-align: left;'>br_cookies</td><td style='text-align: left;'>tinyint(1)</td>
</tr><tr><td style='text-align: left;'>os_name</td><td style='text-align: left;'>varchar(30)</td>
</tr><tr><td style='text-align: left;'>os_family</td><td style='text-align: left;'>varchar(30)</td>
</tr><tr><td style='text-align: left;'>os_manufacturer</td><td style='text-align: left;'>varchar(30)</td>
</tr><tr><td style='text-align: left;'>dvce_type</td><td style='text-align: left;'>varchar(30)</td>
</tr><tr><td style='text-align: left;'>dvce_ismobile</td><td style='text-align: left;'>tinyint(1)</td>
</tr><tr><td style='text-align: left;'>dvce_screenwidth</td><td style='text-align: left;'>mediumint(9)</td>
</tr><tr><td style='text-align: left;'>dvce_screenheight</td><td style='text-align: left;'>mediumint(9)</td>
</tr></tbody></table>
<h2 id='next_steps'>Next steps</h2>

<p>Happy with the SnowPlow events data structure? Then <a href='basic-recipes.html'>dive into some analysis</a>.</p>
</div>

 <div id="sidebar">
	<h1>Analysts Cookbook</h1>
	<p>
		<a href="/analytics/index.html" class="active">Overview</a>
		
		<ul>
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
						
							
							<li><a href="/analytics/index.html">Introduction</a></li>
									
									
					
				
					
									
					
				
					
				
					
									
					
				
					
									
					
				
					
									
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
									
					
				
					
									
					
				
					
				
					
									
					
				
					
						
							
							<li><a href="/analytics/snowplow-data-production.html">Data production</a></li>
									
									
					
				
					
									
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
									
					
				
					
						
							
							<li><a href="/analytics/snowplow-data-storage.html">Data storage</a></li>
									
									
					
				
					
				
					
									
					
				
					
									
					
				
					
									
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
									
					
				
					
									
					
				
					
				
					
									
					
				
					
									
					
				
					
						
							
							<li class="active"><a href="/analytics/snowplow-table-structure.html" class="active">Data structure</a></li>
									
									
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
									
					
				
					
									
					
				
					
				
					
						
							
							<li><a href="/analytics/basic-recipes.html">Basic recipes</a></li>
									
									
					
				
					
									
					
				
					
									
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
									
					
				
					
									
					
				
					
				
					
									
					
				
					
									
					
				
					
									
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
									
					
				
					
									
					
				
					
				
					
									
					
				
					
									
					
				
					
									
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
									
					
				
					
									
					
				
					
				
					
									
					
				
					
									
					
				
					
									
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
									
					
				
					
									
					
				
					
				
					
									
					
				
					
									
					
				
					
									
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
									
					
				
					
									
					
				
					
				
					
									
					
				
					
									
					
				
					
									
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
		</ul>
		
	</p>
	<p>
		<a href="/analytics/customer-analytics/overview.html" >Customer analytics</a>
		
	</p>
	<p>
		<a href="/analytics/platform-analytics/overview.html" >Platform analytics</a>
		
	</p>
	<p>
		<a href="/analytics/catalogue-analytics/overview.html" >Catalogue analytics</a>
		
	</p>
</div>

		<div id="footer">
	<p>Copyright Â© SnowPlow Analytics Limited 2012.  All rights reserved</p>
</div>
	</div>
</body>
</html>