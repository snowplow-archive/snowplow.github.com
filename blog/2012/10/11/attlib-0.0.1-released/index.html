<!DOCTYPE html>
<html>
<head>
	
	<title>Attlib - an open source library for extracting search marketing attribution data from referrer URLs - SnowPlow Analytics</title>
	

	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<link href="/static/css/styles.css" type="text/css" rel="stylesheet" />
	<link href="/static/css/pygments.css" type="text/css" rel="stylesheet" />
	

	<!-- SnowPlow starts plowing -->
	<script type="text/javascript">
	var _snaq = _snaq || [];

	_snaq.push(['setAccount', 'd3v6ndkyapxc2w']);
	_snaq.push(['trackPageView']);
	_snaq.push(['enableLinkTracking']);

	(function() {
	var sp = document.createElement('script'); sp.type = 'text/javascript'; sp.async = true; sp.defer = true;
	sp.src = ('https:' == document.location.protocol ? 'https' : 'http') + '://d1fc8wv8zag5ca.cloudfront.net/sp.js';
	var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(sp, s);
	})();
	 </script>
	<!-- SnowPlow stops plowing -->	

	<!--Google Analytics tracking-->
	<script type="text/javascript">

	  var _gaq = _gaq || [];
	  _gaq.push(['_setAccount', 'UA-34290195-1']);
	  _gaq.push(['_trackPageview']);

	  (function() {
	    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	  })();

	</script>
	<!--Finish Google Analytics tracking-->
</head>
<body>
	<div id="container">
		<div id="header" class="span-24">
  <div id="logo">
    <h1><a href="/">SnowPlow</a></h1>
    <p>Your web analytics data in your hands</p>
  </div>
  <div id="menu" class="span-15">
    <ul>
      <li ><a href="/product/index.html">Product</a></li>
      <li ><a href="/services/index.html">Services</a></li>
      <li ><a href="/analytics/index.html">Analytics</a></li>
      <li ><a href="/technology/index.html">Technology</a></li>
      <li  class="active" ><a href="/blog.html">Blog</a></li>
      <li ><a id="mail" href="/contact/index.html">Contact</a></li>
    </ul>
  </div>
</div>
	
		<div id="contents">
		<div class="post">
			11 Oct 2012
			<h1>Attlib - an open source library for extracting search marketing attribution data from referrer URLs</h1>
			<p>Last night we published <a href='https://github.com/snowplow/attlib'>Attlib</a>, an open source Ruby library for extracting search marketing attribution data from referrer URLs. In this post we talk through:</p>

<ol>
<li><a href='#what_attlib_does'>What Attlib does, and how to use it</a></li>

<li><a href='#install'>Installing Attlib</a></li>

<li><a href='#search_engine_yaml'>The search_engine.yml file</a></li>

<li><a href='#snowplow_stack'>Attlib as part of the SnowPlow stack</a></li>

<li><a href='#other_languages'>Attlib in other languages</a></li>

<li><a href='#snowplow_components_as_standalone_projects'>Making components of SnowPlow available as standalone open source projects</a></li>
</ol>
<a name='what_attlib_does' />
<h3 id='what_attlib_does_and_how_to_use_it'>What Attlib does, and how to use it</h3>

<p>Attlib is straightforward Ruby library for extracting seach marketing attribution data from referrer URLs. You give it a referrer URL: it then lets you now whether the URL is from a search engine. If it is, it will tell you which search engine it is, and what keywords were typed. (If those keywords are included in the query string - this is no longer the case for users logged in to Google, as documented <a href='http://googlewebmastercentral.blogspot.co.uk/2011/10/accessing-search-query-data-for-your.html'>here</a>.)</p>
<div class='highlight'><pre><code class='ruby'><span class='nb'>require</span> <span class='s1'>&#39;attlib&#39;</span>

<span class='n'>r</span> <span class='o'>=</span> <span class='no'>Referrer</span><span class='o'>.</span><span class='n'>new</span><span class='p'>(</span><span class='s1'>&#39;http://images.google.ca/imgres?q=hermetic+tarot&amp;hl=en&amp;biw=1189&amp;bih=521&amp;tbm=isch&amp;tbnid=BuQ_IyUbc25usM:&amp;imgrefurl=http://www.psychicbazaar.com/tarot-cards/15-the-hermetic-tarot.html&amp;imgurl=http://mdm.pbzstatic.com/tarot/the-hermetic-tarot/card-4.png&amp;w=1064&amp;h=1551&amp;ei=ue9AUMe7Osn9iwLZ-4H4Dw&amp;zoom=1&amp;iact=hc&amp;vpx=107&amp;vpy=48&amp;dur=2477&amp;hovh=271&amp;hovw=186&amp;tx=133&amp;ty=157&amp;sig=115588264602219115047&amp;page=4&amp;tbnh=162&amp;tbnw=120&amp;start=57&amp;ndsp=19&amp;ved=1t:429,r:12,s:57,i:291&#39;</span><span class='p'>)</span>

<span class='n'>r</span><span class='o'>.</span><span class='n'>is_search_engine?</span> <span class='c1'># True</span>
<span class='n'>r</span><span class='o'>.</span><span class='n'>search_engine</span> <span class='c1'># &#39;Google Images&#39;</span>
<span class='n'>r</span><span class='o'>.</span><span class='n'>keywords</span> 	<span class='c1'># &#39;hermetic tarot&#39;</span>
</code></pre>
</div><a name='install' />
<h3 id='installing_attlib'>Installing Attlib</h3>

<p>Attlib is available via a Ruby Gem. To install, simply run the following at the command line:</p>

<pre><code>sudo gem install attlib</code></pre>

<p>The sourcecode is available on <a href='https://github.com/snowplow/attlib'>Github</a></p>
<a name='search_engine_yaml' />
<h3 id='the_search_enginesyml_file'>The search_engines.yml file</h3>

<p>Extracting search engine names and keywords from a referrer URL is pretty straightforward. What is more complicated is keeping track of the myriad search engines that are out there, operating in different countries, the myriad domains they operate on, and the different query parameters that each of them uses to store the keywords.</p>

<p>Because the space is constantly evolving, none of this information (about search engines, parameters and domains) has been hard coded into Attlib. All of it is available in the <a href='https://github.com/snowplow/attlib/blob/master/data/search_engines.yml'>search_engines.yml</a> file, in the <a href='https://github.com/snowplow/attlib/tree/master/data'>data</a> in the repo.</p>

<p>The structure of the YAML file should be straightforward to understand. Each search engine is a top level item. For each search engine, two lists are given: one is a list of parameters used in that search engine&#8217;s query string to identify the keywords entered. The other is the list of domains on which that search engine operates. An extract is shown below:</p>
<div class='highlight'><pre><code class='yaml'><span class='l-Scalar-Plain'>Babylon</span><span class='p-Indicator'>:</span>
  <span class='l-Scalar-Plain'>parameters</span><span class='p-Indicator'>:</span> 
    <span class='p-Indicator'>-</span> <span class='l-Scalar-Plain'>q</span>
  <span class='l-Scalar-Plain'>domains</span><span class='p-Indicator'>:</span> 
   <span class='p-Indicator'>-</span> <span class='l-Scalar-Plain'>search.babylon.com</span>
   <span class='p-Indicator'>-</span> <span class='l-Scalar-Plain'>searchassist.babylon.com</span>

<span class='l-Scalar-Plain'>Baidu</span><span class='p-Indicator'>:</span>
  <span class='l-Scalar-Plain'>parameters</span><span class='p-Indicator'>:</span> 
    <span class='p-Indicator'>-</span> <span class='l-Scalar-Plain'>wd</span>
    <span class='p-Indicator'>-</span> <span class='l-Scalar-Plain'>word</span>
    <span class='p-Indicator'>-</span> <span class='l-Scalar-Plain'>kw</span>
    <span class='p-Indicator'>-</span> <span class='l-Scalar-Plain'>k</span>
  <span class='l-Scalar-Plain'>domains</span><span class='p-Indicator'>:</span>
    <span class='p-Indicator'>-</span> <span class='l-Scalar-Plain'>www.baidu.com</span>
    <span class='p-Indicator'>-</span> <span class='l-Scalar-Plain'>www1.baidu.com</span>
    <span class='p-Indicator'>-</span> <span class='l-Scalar-Plain'>zhidao.baidu.com</span>
    <span class='p-Indicator'>-</span> <span class='l-Scalar-Plain'>tieba.baidu.com</span>
    <span class='p-Indicator'>-</span> <span class='l-Scalar-Plain'>news.baidu.com</span>
    <span class='p-Indicator'>-</span> <span class='l-Scalar-Plain'>web.gougou.com</span>
</code></pre>
</div>
<p>Keeping this file up to date is a big job: one of our hopes releasing Attlib as an open source, standalone library, is that the community contributes to the file. We are enormously grateful to our friends at <a href='http://piwik.org/'>Piwik</a> as our initial version of the file is based on the Piwik equivalent <a href='https://github.com/piwik/piwik/blob/master/core/DataFiles/SearchEngines.php'>SearchEngines.php</a>, for the hard work they put into this version.</p>
<a name='snowplow_stack' />
<h3 id='attlib_as_part_of_the_snowplow_stack'>Attlib as part of the SnowPlow stack</h3>

<p>Our intention is to port <a href='https://github.com/snowplow/attlib'>Attlib</a> into Scala and integrate it into the SnowPlow stack: specifically the ETL phase. Both Ruby and Scala versions of Attlib will run based on the same <a href='https://github.com/snowplow/attlib/blob/master/data/search_engines.yml'>search_engines.yml</a> file.</p>
<a name='other_languages' />
<h3 id='attlib_in_other_languages'>Attlib in other languages</h3>

<p>As well as contributing to the search <a href='https://github.com/snowplow/attlib/blob/master/data/search_engines.yml'>search_engines.yml</a> file, we also hope that community members will develop versions of Attlib in other languages e.g. Python.</p>
<a name='snowplow_components_as_standalone_projects' />
<h3 id='making_components_of_snowplow_available_as_standalone_open_source_projects'>Making components of SnowPlow available as standalone open source projects</h3>

<p>Attlib is the first component in the SnowPlow stack that we have released as a standalone library. There are many more in the pipeline. (More on this in future blog posts :-) ). For us, this is a key part of the SnowPlow strategy:</p>

<ol>
<li>Keeping the SnowPlow architecture as loosely coupled as possible. We believe this makes SnowPlow robust, scalable and extendable</li>

<li>Grow the userbase of people using and contributing to each component. Processing web analytics data is a big job: there are many individual components involved, and each of them needs to evolve with the changing marketplace. Attlib is concerned today with extracting useful data from search engine referrers: but it is likely that as time goes on, we&#8217;ll want to extend it to capture data from other types of referrers e.g. social networks or affiliate sites. The bigger the community of people on top of those developments, the better for everyone in the web analytics community. Releasing each component as a standalone open source library should help grow that community.</li>
</ol>
<hr />
<p>Any questions about Attlib, or anything else in this post? Then <a href='/contact/index.html'>get in touch</a> with the SnowPlow team.</p>
			<div id="comments">
	<h2>Questions? Comments? Join the debate!</h2>
	 <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'snowplow'; // required: replace example with your forum shortname
            /* var disqus_identifier =  ; // unique ID so that disqus fetches the correct comments for each post
            var disqus_url =  ;
            var disqus_title =  ; */

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
		</div>
		<p>Return to the <a href="/blog.html">main blog page</a></p>

</div>

<div id="sidebar">
	<h1>Recent posts</h1>
	<ul>
		
			<li><a href="/blog/2012/10/11/snowplow-0.4.10-released">SnowPlow 0.4.10 released</a></li>
		
			<li><a href="/blog/2012/10/11/attlib-0.0.1-released">Attlib - an open source library for extracting search marketing attribution data from referrer URLs</a></li>
		
			<li><a href="/blog/2012/09/24/what-does-snowplow-let-you-do">Why set your data free?</a></li>
		
			<li><a href="/blog/2012/09/14/snowplow-0.4.8-released">SnowPlow 0.4.8 released</a></li>
		
			<li><a href="/blog/2012/09/06/snowplow-0.4.7-released">SnowPlow 0.4.7 released</a></li>
		
			<li><a href="/blog/2012/08/21/amazon-glacier-launch">Amazon announces Glacier - lowers the cost of running SnowPlow</a></li>
		
			<li><a href="/blog/2012/08/20/snowplow-0.4.6-released">SnowPlow 0.4.6 released</a></li>
		
			<li><a href="/blog/2012/08/14/updated-hive-serde-released">Updated Hive SerDe released</a></li>
		
			<li><a href="/blog/2012/08/13/introducing-snow-cannon-a-node-js-collector-for-snowplow">SnowCannon - a node.js collector for SnowPlow</a></li>
		
			<li><a href="/blog/2012/08/02/snowplow-setup-documentation-overhauled">The setup guide has been overhauled</a></li>
		
	</ul>
	<h1>Useful links</h1>
	<ul>
		<li><a href="/blog/atom.xml">Atom feed</a></li>
	</ul>
	<!--<strong>Tags</strong> -->
</div>

		<div id="footer">
	<p>Copyright Â© SnowPlow Analytics Limited 2012.  All rights reserved</p>
</div>
	</div>
	<!-- Following Javascript function used by Disqus to count the number of comments for each blog post and display in the main index -->
	  <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'snowplow'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
        </script>
</body>
</html>